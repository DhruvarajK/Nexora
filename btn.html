
<html>
    <head><style>
        /* Basic styles for the container and particles */
        #CanavaView {
          position: fixed;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          pointer-events: none; /* allow clicks through */
          overflow: hidden;
          z-index: 0; /* adjust if needed */
        }
      
        .cv-particle {
          position: absolute;
          left: 0;
          top: 0;
          will-change: transform, opacity, width, height;
          border-radius: 50%;
          transform-origin: 50% 50%;
          /* We'll set size, background and opacity inline for each particle */
        }
      </style></head>
      <body>
        
        <div id="ParticleContainer" style="position: relative; overflow: hidden; width: 100vw; height: 100vh; background: transparent; filter: blur(14px);"></div>

        <script>
            
const container = document.getElementById('ParticleContainer');

if (!container) throw new Error("Div element with id 'ParticleContainer' not found");

let particles = [];
let w = 0, h = 0;
let speedMultiplier = 15;
let particleSize = 100;
let particleOpacity = 0.1;
let colorHue = 190;

let animationId = null;
let isAnimating = false;
let resizeTimeout = null;

function resizeContainer() {
  w = Math.floor(window.innerWidth);
  h = Math.floor(window.innerHeight);
  container.style.width = w + 'px';
  container.style.height = h + 'px';
}

function handleResizeDebounced() {
  if (resizeTimeout) clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(() => {
    init();
    resizeTimeout = null;
  }, 120);
}

class Particle {
  constructor() {
    this.element = document.createElement('div');
    this.element.style.position = 'absolute';
    this.element.style.borderRadius = '50%';
    this.element.style.pointerEvents = 'none';
    this.element.style.background = 'transparent';
    this.element.style.filter = 'blur(0.5px)'; // slight blur for softness
    container.appendChild(this.element);
    this.reset();
  }

  reset() {
    this.x = Math.random() * w;
    this.y = Math.random() * h;
    this.targetSize = particleSize + Math.random() * 100;
    this.size = this.targetSize;
    this.baseSpeedX = (Math.random() - 0.5) * 0.5;
    this.baseSpeedY = (Math.random() - 0.5) * 0.5;
    this.baseOpacity = particleOpacity;
    this.hue = colorHue + Math.random() * 15;
    this.pulseOffset = Math.random() * Math.PI * 2;
    this.updateStyle();
  }

  updateStyle() {
    const pulse = Math.sin(this.pulseOffset) * 0.15 + 1;
    const currentSize = this.size * pulse;
    const half = currentSize / 2;
    this.element.style.left = (this.x - half) + 'px';
    this.element.style.top = (this.y - half) + 'px';
    this.element.style.width = currentSize * 2 + 'px';
    this.element.style.height = currentSize * 2 + 'px';

    const grad1 = `hsla(${this.hue},100%,65%,${this.baseOpacity})`;
    const grad2 = `hsla(${this.hue},100%,60%,${this.baseOpacity * 0.7})`;
    const grad3 = `hsla(${this.hue},100%,55%,0)`;
    this.element.style.background = `radial-gradient(circle at center, ${grad1}, ${grad2} 40%, ${grad3} 100%)`;
  }

  update() {
    this.x += this.baseSpeedX * speedMultiplier;
    this.y += this.baseSpeedY * speedMultiplier;

    // wrap
    if (this.x < -this.size) this.x = w + this.size;
    if (this.x > w + this.size) this.x = -this.size;
    if (this.y < -this.size) this.y = h + this.size;
    if (this.y > h + this.size) this.y = -this.size;

    // small random walk
    if (Math.random() < 0.01) {
      this.baseSpeedX += (Math.random() - 0.5) * 0.1;
      this.baseSpeedY += (Math.random() - 0.5) * 0.1;
      this.baseSpeedX = Math.max(-0.8, Math.min(0.8, this.baseSpeedX));
      this.baseSpeedY = Math.max(-0.8, Math.min(0.8, this.baseSpeedY));
    }

    this.size += (this.targetSize - this.size) * 0.05;
    this.pulseOffset += 0.02;
    this.updateStyle();
  }
}

function init() {
  resizeContainer();

  // Clear old particles
  particles.forEach(p => {
    if (p.element && p.element.parentNode) {
      p.element.parentNode.removeChild(p.element);
    }
  });
  particles = [];

  const particleCount = 15;
  for (let i = 0; i < particleCount; i++) {
    particles.push(new Particle());
  }
}

function animate() {
  for (let i = 0; i < particles.length; i++) {
    const p = particles[i];
    p.update();
  }

  animationId = requestAnimationFrame(animate);
}

function handleVisibilityChange() {
  if (document.hidden) {
    stopAnimation();
  } else {
    startAnimation();
  }
}

function toggleAnimation() {
  if (isAnimating) stopAnimation();
  else startAnimation();
  return isAnimating;
}

function startAnimation() {
  if (isAnimating) return;
  isAnimating = true;
  if (!animationId) animationId = requestAnimationFrame(animate);
}

function stopAnimation() {
  if (!isAnimating) return;
  isAnimating = false;
  if (animationId) {
    cancelAnimationFrame(animationId);
    animationId = null;
  }
}

function destroy() {
  stopAnimation();
  window.removeEventListener('resize', handleResizeDebounced);
  document.removeEventListener('visibilitychange', handleVisibilityChange);
  if (resizeTimeout) clearTimeout(resizeTimeout);
  particles.forEach(p => {
    if (p.element && p.element.parentNode) {
      p.element.parentNode.removeChild(p.element);
    }
  });
  particles = [];
}

window.addEventListener('resize', handleResizeDebounced, { passive: true });
document.addEventListener('visibilitychange', handleVisibilityChange);

window.addEventListener('load', () => {
  init();
  startAnimation();
});
        </script>
    
      </body>
</html>

